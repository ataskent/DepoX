<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="DepoX.Features.Count.CountPage"
    Title="SayÄ±m">

    <Grid>

        <!-- ===================== -->
        <!-- ðŸ”¹ ANA SAYFA -->
        <!-- ===================== -->
        <Grid RowDefinitions="Auto,*,Auto"
              Padding="10"
              RowSpacing="8">

            <!-- Barkod -->
            <Entry
                Grid.Row="0"
                x:Name="BarcodeEntry"
                Placeholder="Barkod okutun"
                ReturnType="Done"
                Completed="OnBarcodeCompleted"
                ClearButtonVisibility="Never" />

            <!-- Liste -->
            <CollectionView
                Grid.Row="1"
                ItemsSource="{Binding Items}"
                SelectionMode="None">

                <CollectionView.ItemTemplate>
                    <DataTemplate>

                        <SwipeView>

                            <SwipeView.LeftItems>
                                <SwipeItems Mode="Reveal">
                                    <SwipeItem
                                        Text="Sil"
                                        BackgroundColor="Tomato"
                                        Invoked="OnSwipeDelete"
                                        CommandParameter="{Binding .}" />
                                </SwipeItems>
                            </SwipeView.LeftItems>

                            <Grid Padding="8"
                                  ColumnDefinitions="*,Auto"
                                  BackgroundColor="#F8FAFF">

                                <Label
                                    Text="{Binding Barcode}"
                                    FontSize="14"
                                    VerticalOptions="Center" />

                                <Label
                                    Grid.Column="1"
                                    Text="{Binding Quantity}"
                                    FontSize="14"
                                    FontAttributes="Bold"
                                    VerticalOptions="Center"
                                    HorizontalTextAlignment="End" />
                            </Grid>

                        </SwipeView>

                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Kaydet -->
            <Button
                Grid.Row="2"
                Text="Kaydet"
                Clicked="OnSaveClicked"
                Margin="0,8,0,0" />

        </Grid>

        <!-- ===================== -->
        <!-- ðŸ”¹ BUSY OVERLAY -->
        <!-- ===================== -->
        <Grid
            BackgroundColor="#80000000"
            IsVisible="{Binding IsBusy}"
            InputTransparent="False">

            <VerticalStackLayout
                HorizontalOptions="Center"
                VerticalOptions="Center"
                Spacing="12">

                <ActivityIndicator
                    IsRunning="True"
                    Color="White"
                    WidthRequest="48"
                    HeightRequest="48" />

                <Label
                    Text="Kaydediliyor..."
                    TextColor="White"
                    FontSize="14" />
            </VerticalStackLayout>

        </Grid>

    </Grid>
</ContentPage>
